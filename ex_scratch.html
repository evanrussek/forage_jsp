
<!DOCTYPE html>
<html>
  <head>
    <title>My experiment</title>
    <script src="jspsych-6.0.5/jspsych.js"></script>
    <script src="jspsych-6.0.5/plugins/jspsych-fullscreen.js"></script>
    <script src="jspsych-6.0.5/evan_plugins/jspsych-evan-travel-mkre.js"></script>
    <script src="jspsych-6.0.5/evan_plugins/jspsych-evan-display-text.js"></script>
    <link href="jspsych-6.0.5/css/jspsych.css" rel="stylesheet" type="text/css"></link>
    <link rel='stylesheet' type='text/css' href='default_style.css'>
    <link rel='stylesheet' type='text/css' href='style.css'>
    <script type="text/javascript" src="jspsych-6.0.5/d3.min.js"></script>
  </head>
  <body></body>
  <script type="text/javascript" src="parameters.js"></script>
  <script>
/// todo: make instructions, let particpants know how many points they collected. 
  /* */
  /* create timeline */
  var timeline = [];

  var full_screen = {
    type: 'fullscreen',
    fullscreen_mode: true
  };


// we'll vary the travel amount?
var travel_amounts = [8, 16, 32];
var harvest_key_seq = ['f', 'j', 'f', 'j'];
var harvest_prompt = ["(F -> J -> F -> J)"];

var travel_key_seq_easy = ['d', 'k', 'd', 'k'];
var travel_prompt_easy = ["(D -> K -> D -> K)"];
var travel_key_seq_hard =['z', '/', 't', 'y'];
var travel_prompt_hard = ["(Z -> / -> T -> Y)"];

// need to record errors...

var this_round_trials = [];
for (d_idx = 0; d_idx < 2; d_idx++){
  for (ta_idx = 0; ta_idx < travel_amounts.length; ta_idx++){
    var this_travel_amount = travel_amounts[ta_idx];
    if (d_idx == 0){
        var this_travel_key_seq = travel_key_seq_easy;
        var this_travel_prompt = travel_prompt_easy;
    }else{
      var this_travel_key_seq = travel_key_seq_hard;
      var this_travel_prompt = travel_prompt_hard;
    }
    var this_trial = {
      type: 'travel-mkre',
      start_reward: 100,
      decay: .98,
      n_travel_steps: this_travel_amount,
      press_success_prob_travel: .7,
      press_success_prob_harvest: .7,
      reward_noise: 2.5,
      start_reward_noise: 4,
      time_min: 2,
      travel_key_seq:this_travel_key_seq,
      travel_prompt: this_travel_prompt,
      harvest_key_seq: harvest_key_seq,
      harvest_prompt: harvest_prompt
    }
    this_round_trials.push(this_trial)
  }
}

var make_text_trial = function(travel_prompt, harvest_prompt){
  var text_trial = {
    type: 'evan-display-text',
    line_1: "Traveling to a new environment",
    line_2: "Travel sequence: " + travel_prompt + ", Harvest sequence: " + harvest_prompt,
    line_3: ""
  }
  return text_trial
}

// shuffle these
trials = this_round_trials;

// shuffled_trials = jsPsych.randomization.shuffle(trials,1);

// need to also record errors

/* create timeline */
var timeline = [];
timeline.push(full_screen);

for (i = 0; i < trials.length; i++){
  var next_trial = trials[i];
  var text_trial = make_text_trial(next_trial.travel_prompt, next_trial.harvest_prompt)
  timeline.push(text_trial);
  timeline.push(next_trial);
}

/* start the experiment */
jsPsych.init({
  timeline: timeline,
  show_preload_progress_bar: false,
  on_finish: function() {
    //console.log('done')
    jsPsych.data.get().localSave('csv','test_res.csv');
  //on_finish: saveData
  }
});

</script>
</html>
