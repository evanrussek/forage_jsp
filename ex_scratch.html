
<!DOCTYPE html>
<html>
  <head>
    <title>My experiment</title>
    <script src="jspsych-6.0.5/jspsych.js"></script>
    <script src="jspsych-6.0.5/plugins/jspsych-fullscreen.js"></script>
    <script src="jspsych-6.0.5/evan_plugins/jspsych-evan-travel.js"></script>
    <script src="jspsych-6.0.5/evan_plugins/jspsych-evan-display-text.js"></script>
    <link href="jspsych-6.0.5/css/jspsych.css" rel="stylesheet" type="text/css"></link>
    <link rel='stylesheet' type='text/css' href='default_style.css'>
    <link rel='stylesheet' type='text/css' href='style.css'>
    <script type="text/javascript" src="jspsych-6.0.5/d3.min.js"></script>
  </head>
  <body></body>
  <script type="text/javascript" src="parameters.js"></script>
  <script>

  /* */
  /* create timeline */
  var timeline = [];

  var full_screen = {
    type: 'fullscreen',
    fullscreen_mode: true
  };

  var travel1 = {
    type: 'travel',
    start_reward: 100,
    decay: .98,
    n_travel_steps: 12,
    press_success_prob_travel: .7,
    press_success_prob_harvest: .7,
    reward_noise: 2.5,
    start_reward_noise: 4,
    time_min: 2,
    travel_key: 'f',
    travel_key_cap: 'F',
    harvest_key: 'j',
    harvest_key_cap: 'J'
  }

  var travel2 = {
    type: 'travel',
    start_reward: 100,
    decay: .98,
    n_travel_steps: 30,
    press_success_prob_travel: .7,
    press_success_prob_harvest: .7,
    reward_noise: .5,
    start_reward_noise: 4,
    time_min: 2.5,
    travel_key: 'f',
    travel_key_cap: 'F',
    harvest_key: 'j',
    harvest_key_cap: 'J'
  }


  var travel3 = {
    type: 'travel',
    start_reward: 100,
    decay: .98,
    n_travel_steps: 12,
    press_success_prob_travel: .7,
    press_success_prob_harvest: .7,
    reward_noise: .5,
    start_reward_noise: 4,
    time_min: 2.5,
    travel_key: 'a',
    travel_key_cap: 'A',
    harvest_key: 'j',
    harvest_key_cap: 'J'
  }

  var travel4 = {
    type: 'travel',
    start_reward: 100,
    decay: .98,
    n_travel_steps: 30,
    press_success_prob_travel: .7,
    press_success_prob_harvest: .7,
    reward_noise: .5,
    start_reward_noise: 4,
    time_min: 2.5,
    travel_key: 'a',
    travel_key_cap: 'A',
    harvest_key: 'j',
    harvest_key_cap: 'J'
  }

var make_text_trial = function(travel_key_cap, harvest_key_cap){
  var text_trial = {
    type: 'evan-display-text',
    line_1: "Traveling to a new environment",
    line_2: "Travel key: " + travel_key_cap + ", Harvest key: " + harvest_key_cap,
    line_3: ""
  }
  return text_trial
}


// https://raw.githack.com/evanrussek/forage_jsp/master/ex_scratch.html

// shuffle these
trials = [travel1, travel2, travel3, travel4];

shuffled_trials = jsPsych.randomization.shuffle(trials,1);

/* create timeline */
var timeline = [];
timeline.push(full_screen);

for (i = 0; i < shuffled_trials.length; i++){
  var next_trial = shuffled_trials[i];
  var text_trial = make_text_trial(next_trial.travel_key_cap, next_trial.harvest_key_cap)
  timeline.push(text_trial);
  timeline.push(next_trial);
}

//timeline = [full_screen, block1_node, block2_node];
//timeline = [full_screen].concat(shuffled_trials);
//timeline = [full_screen button_trial];
//timeline = [full_screen,inst_trial];
//timeline = [full_screen, choice_trial, choice_trial, choice_trial, choice_trial];
  /* start the experiment */
  jsPsych.init({
    timeline: timeline,
    show_preload_progress_bar: false,
    on_finish: function() {
      //console.log('done')
      jsPsych.data.get().localSave('csv','test_res.csv');
    //on_finish: saveData
  }
});

</script>
</html>
