---
title: "R Notebook"
output: html_notebook
---


```{r}
setwd("C:/Users/erussek/forage_jsp/analysis")
rm(list = ls())
library(tidyr)
library(dplyr)
library(zoo)
library(ggplot2)
library(ggpubr)
library(RcppRoll)

source("plot_funcs.R")
```


```{r}
data <- read.csv('data\\run1_data.csv')
head(data)
data <- data %>% ungroup() %>% bind_cols(s_num = group_indices(., subjectID))


```

```{r}

for (s in 1:10){
  subj_data <- data %>% filter(s_num == s)
  subj_data <- clean_subj_data(subj_data)
  plot_subj_basic(subj_data)  
}




```

```{r}

r1_den <- ggplot(subj_data %>% filter(rep_number == 1), aes(x = lag)) + geom_density(aes(fill = phase), alpha = 0.5) + facet_grid(n_travel_steps ~ travel_key_cond) + xlim(0,500)

r2_den <- ggplot(subj_data %>% filter(rep_number == 2), aes(x = lag)) + geom_density(aes(fill = phase), alpha = 0.5) + facet_grid(n_travel_steps ~ travel_key_cond) + xlim(0,500)
#ggdensity(subj_data %>% filter(trial_num == 1), x = "lag", fill = "phase", add = #"median", color = "phase")

ggarrange(r1_den, r2_den, common.legend = TRUE)

# look at just harvest times...
ggplot(subj_data %>% filter(phase == "HARVEST", rep_number == 1), aes(x = lag)) + geom_density(aes(fill = travel_key_cond), alpha = 0.5) + facet_grid(n_travel_steps ~ .) + xlim(0,500) + ggtitle("harvest period rts by condition")

# look at just harvest times...
ggplot(subj_data %>% filter(phase == "TRAVEL", rep_number == 1), aes(x = lag)) + geom_density(aes(fill = travel_key_cond), alpha = 0.5) + facet_grid(n_travel_steps ~ .) + xlim(0,500) + ggtitle("travel period rts by condition")


# effect of harvests on RTs?
rt_ts_r1 <- ggplot(subj_data %>% filter(rep_number == 1), aes(x=lag)) + geom_density(aes(fill = factor(n_travel_steps)), alpha = .8) + facet_grid(phase ~ travel_key_cond) + xlim(0,300) + geom_vline(aes(xintercept = 1))
rt_ts_r2 <- ggplot(subj_data %>% filter(rep_number == 2), aes(x=lag)) + geom_density(aes(fill = factor(n_travel_steps)), alpha = .8) + facet_grid(phase ~ travel_key_cond) + xlim(0,300) + geom_vline(aes(xintercept = 1))

ggarrange(rt_ts_r1, rt_ts_r2, common.legend = TRUE)
 
```
```{r}

subj_data %>% filter(travel_key_cond == "HARD", rep_number == 1)
```

